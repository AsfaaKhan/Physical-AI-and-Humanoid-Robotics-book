# Data Model: RAG Knowledge Ingestion Pipeline

## Overview
Data model for the RAG knowledge ingestion pipeline that extracts content from the Docusaurus book website and stores it in Qdrant for retrieval.

## Core Entities

### ContentChunk
- **Description**: Represents a semantically coherent segment of extracted text with metadata
- **Fields**:
  - `id` (string): Unique identifier for the chunk (UUID format)
  - `text_content` (string): The actual text content of the chunk
  - `source_url` (string): Original URL where the content was found
  - `page_title` (string): Title of the page containing this content
  - `chunk_index` (integer): Sequential index of this chunk within the page
  - `created_at` (datetime): Timestamp when chunk was created
  - `metadata` (dict): Additional metadata (author, section, tags, etc.)

### VectorEmbedding
- **Description**: High-dimensional numerical representation of text content generated by Cohere models
- **Fields**:
  - `vector` (list[float]): The actual embedding vector (typically 1024-4096 dimensions)
  - `embedding_model` (string): Name of the model used to generate the embedding
  - `embedding_version` (string): Version of the embedding model
  - `vector_size` (integer): Dimensionality of the vector

### KnowledgeEntry
- **Description**: Combined entity containing both the original content chunk and its vector embedding stored in Qdrant
- **Fields**:
  - `id` (string): Primary key, matches the ContentChunk.id
  - `content_chunk` (ContentChunk): The original text content and metadata
  - `vector_embedding` (VectorEmbedding): The vector representation
  - `collection_name` (string): Name of the Qdrant collection
  - `indexed_at` (datetime): Timestamp when entry was indexed in Qdrant

## Qdrant Collection Schema

### Collection: rag_embedding_physical_ai_book
- **Vector Configuration**:
  - Vector name: "embedding"
  - Size: 1024 (for Cohere embed-multilingual-v3.0 medium model)
  - Distance: Cosine similarity
- **Payload Fields**:
  - `text_content` (keyword): The text content (indexed for filtering)
  - `source_url` (keyword): Source URL (indexed for filtering)
  - `page_title` (keyword): Page title (indexed for filtering)
  - `chunk_index` (integer): Chunk index (indexed for ordering)
  - `created_at` (integer): Creation timestamp (indexed for time-based queries)
  - `metadata` (object): Additional metadata

## Relationships
- Each `ContentChunk` generates one `VectorEmbedding`
- One `KnowledgeEntry` combines a `ContentChunk` and its corresponding `VectorEmbedding`
- Multiple `KnowledgeEntry` objects are stored in the same Qdrant collection

## Validation Rules
- `text_content` must be between 50 and 2000 characters (for optimal embedding quality)
- `source_url` must be a valid URL format
- `chunk_index` must be non-negative
- `vector` must have consistent dimensions across all entries
- `id` must be unique within the collection

## State Transitions
- `ContentChunk` starts in "extracted" state, moves to "chunked" after processing
- `VectorEmbedding` starts in "generated" state after embedding creation
- `KnowledgeEntry` starts in "created" state, moves to "indexed" after Qdrant storage